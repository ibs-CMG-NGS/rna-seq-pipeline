# RNA-seq Pipeline Configuration File - TEMPLATE
# 
# 사용 방법:
# 1. 이 파일을 복사하여 프로젝트별 설정 파일 생성: 
#    cp config/default.yaml config/projects/<project_name>.yaml
# 2. 프로젝트에 맞게 설정 수정 (경로, species, 파라미터 등)
# 3. Snakemake 실행 시 --configfile 옵션 사용: 
#    snakemake --configfile config/projects/<project_name>.yaml
#
# 예시: snakemake --configfile config/projects/H2O2_human_2025.yaml --cores 8
#
# 주의: config/projects/ 내 파일은 Git에서 추적됩니다 (프로젝트 재현성).
#       개인 테스트용은 config_*.yaml로 만들면 .gitignore 처리됩니다.

# === Directory Structure ===
# Input/Output directory configuration
data_dir: "/path/to/fastq/data"  # FASTQ 파일 위치 (절대경로 권장)
raw_data_subdir: ""  # FASTQ 파일이 data_dir 바로 아래에 있으면 비워둠, 서브폴더면 지정

# === Sample Sheet Configuration ===
# 샘플 정보를 CSV 파일에서 읽기 (권장) 또는 FASTQ 파일명에서 자동 추출
use_sample_sheet: false  # true: CSV에서 읽기, false: glob으로 자동 감지 (기본값)
sample_sheet: "config/samples/master.csv"  # 샘플 시트 경로

# use_sample_sheet: true 사용 시 장점:
#   - 샘플 메타데이터 활용 (condition, replicate, tissue 등)
#   - FASTQ 경로를 샘플 시트에서 직접 지정 가능
#   - 프로젝트별 샘플 자동 필터링 (project_id 기준)
#   - 조건별 분석 및 QC 그룹화 지원
# use_sample_sheet: false 사용 시:
#   - 빠른 테스트 및 간단한 분석
#   - FASTQ 파일명 패턴 자동 감지 (6가지 지원)

# === Standardized Output Structure ===
# 표준 디렉토리 구조: {base_results_dir}/{project_id}/{sample_id}/{pipeline_type}/
use_standard_structure: true  # 표준 디렉토리 구조 사용 여부 (권장: true)
project_id: "PROJECT_NAME"  # 프로젝트 ID (config/samples/master.csv와 일치시킬 것)
pipeline_type: "rna-seq"  # 파이프라인 타입 (rna-seq, chip-seq, wgs 등)

# Legacy structure (use_standard_structure: false인 경우)
results_dir: "results"  # 기존 결과 저장 위치
trimmed_subdir: "trimmed"  # Subdirectory for trimmed reads
aligned_subdir: "aligned"  # Subdirectory for aligned BAM files
counts_subdir: "counts"  # Subdirectory for count matrices
qc_subdir: "qc"  # Subdirectory for QC reports
logs_dir: "logs"  # 로그 파일 저장 위치

# Standard structure (use_standard_structure: true인 경우)
base_results_dir: "/path/to/results"  # 표준 결과 베이스 디렉토리 (절대경로 권장)
# 실제 경로: {base_results_dir}/{project_id}/{sample_id}/{pipeline_type}/

# === Reference Files ===
genome_dir: "/path/to/genome/reference"  # Genome reference 위치 (절대경로 권장)
star_index: "/path/to/genome/reference/star_index/"  # STAR genome index directory
annotation_gtf: "/path/to/genome/reference/genes.gtf"  # Gene annotation GTF file

# Species별 예시:
# Human GRCh38: /home/ngs/data/genome/human_GRCh38
# Mouse GRCm39: /home/ngs/data/genome/mouse_GRCm39
# Rat: /home/ngs/data/genome/rat_Rnor_6.0

# === Adapter Sequences ===
# Illumina TruSeq adapters (default)
adapter_r1: "AGATCGGAAGAGCACACGTCTGAACTCCAGTCA"
adapter_r2: "AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT"

# === Quality Control Parameters ===
quality_cutoff: 20  # Minimum base quality for trimming
min_read_length: 20  # Minimum read length after trimming
fastqc_threads: 2  # Number of threads for FastQC

# === Trimming Parameters ===
cutadapt_threads: 4  # Number of threads for cutadapt trimming

# === Alignment Parameters ===
star_threads: 12  # Number of threads for STAR alignment (optimized for 12-core CPU)
star_memory_gb: 35  # Memory limit per STAR job in GB (adjust based on available RAM)
star_sort_memory_bytes: 30000000000  # RAM limit for BAM sorting (30GB)
gzipped_fastq: true  # Whether input FASTQ files are gzipped

# === Quantification Parameters ===
featurecounts_threads: 8  # Number of threads for featureCounts
feature_type: "exon"  # Feature type to count
attribute_type: "gene_id"  # GTF attribute to use as feature ID
strandedness: 0  # 0=unstranded, 1=stranded (forward), 2=stranded (reverse) - 시퀀싱 프로토콜 확인 필요

# === QC Report Parameters ===
generate_qc_report: true  # Generate HTML QC report
generate_multiqc: true  # Generate MultiQC comprehensive report
qc_report_filename: "qc_report.html"  # QC report filename
qc_top_genes: 10  # Number of top expressed genes to show per sample

# === FastQC Auto-Evaluation Parameters ===
fastqc_evaluation:
  enabled: true  # Enable automatic FastQC evaluation
  
  # Basic Statistics thresholds
  # ⚠️ Species별 GC content 조정 필요:
  #    - Human (GRCh38): 35-65% (GC ~40-45%)
  #    - Mouse (GRCm39): 40-55% (GC ~42%)
  #    - Rat (Rnor_6.0): 40-55% (GC ~42%)
  min_total_sequences: 5000000  # Minimum 5M reads for RNA-seq
  min_gc_content: 35  # Minimum GC% (species-dependent, 위 주석 참고)
  max_gc_content: 65  # Maximum GC% (species-dependent, 위 주석 참고)
  
  # Quality Score thresholds
  min_median_quality: 28  # Minimum median Phred score (Q28+)
  min_lower_quartile: 20  # Minimum lower quartile Phred score (Q20+)
  min_q30_percentage: 75  # Minimum percentage of reads with Q30+ (75%)
  
  # N content thresholds
  max_n_content: 5.0  # Maximum N% allowed (5%)
  critical_n_content: 10.0  # Critical N% threshold (10%)
  
  # Adapter content thresholds
  max_adapter_trimmed: 1.0  # Maximum adapter% after trimming (1%)
  warn_adapter_raw: 10.0  # Warning threshold for raw data adapter% (10%)
  
  # Output files
  evaluation_report: "fastqc_evaluation.txt"  # Text report file
  evaluation_json: "fastqc_evaluation.json"  # JSON results file
